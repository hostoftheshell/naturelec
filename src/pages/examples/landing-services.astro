---
import { getCollection, getEntry } from "astro:content";
import About from "@/components/about/About.astro";
import AboutMe from "@/components/about/AboutMe.astro";
import AboutNumbers from "@/components/about/AboutNumbers.astro";
import AboutNumbersImage from "@/components/about/AboutNumbersImage.astro";
import Contact from "@/components/contact/Contact.astro";
import ContactCentered from "@/components/contact/ContactCentered.astro";
import FaqAccordionsSideImage from "@/components/faq/FaqAccordionsSideImage.astro";

import FeatureLightboxMarquee from "@/components/feature/FeatureLightboxMarquee.astro";
import WarrantySteps from "@/components/feature/WarrantySteps.astro";
import HeroBackgroundImage from "@/components/hero/HeroBackgroundImage.astro";
import LogoNaturelecMarquee from "@/components/logo-cloud/LogoNaturelecMarquee.astro";
import HomePageMap from "@/components/map/HomePageMap.astro";
import ServicesCards from "@/components/services/ServicesCards.astro";
import ServicesSwiper from "@/components/services/ServicesSwiper.astro";
import SideNav from "@/components/nav/side-nav.astro";
import TeamSwiper from "@/components/team/TeamSwiper.astro";
import TestimonialsSideImage from "@/components/testimonials/TestimonialsSideImage.astro";
import TestimonialsSwiperSide from "@/components/testimonials/TestimonialsSwiperSide.astro";
import { getLocaleFromUrl } from "@/js/localeUtils";
import { getTranslatedData } from "@/js/translationUtils";
import BaseLayout from "@/layouts/BaseLayout.astro";

// Get locale information
const currLocale = getLocaleFromUrl(Astro.url);
const siteData = getTranslatedData("siteData", currLocale);
import { contactData } from "@/config/fr/contactData.json";
const aboutEntries = await getCollection("about");
const about = aboutEntries[0];

const galleryEntries = await getCollection("homepageGallery");
let galleryData = galleryEntries.find((entry) => entry.id === currLocale);
if (!galleryData) {
	galleryData = galleryEntries.find((entry) => entry.id === "fr");
}

const locationEntries = await getCollection("location");
let locationData = locationEntries.find((entry) => entry.id === currLocale);
if (!locationData) {
	locationData = locationEntries.find((entry) => entry.id === "fr");
}

const heroEntries = await getCollection("hero");
let heroData = heroEntries.find((entry) => entry.id === currLocale);
if (!heroData) {
	heroData = heroEntries.find((entry) => entry.id === "fr");
}
---

<BaseLayout title={siteData.title} description={siteData.description}>
	<SideNav
		phoneHref={contactData.phone_link}
		locationHref="https://maps.google.com/"
		facebookHref={contactData.facebook}
	/>
	{heroData && <HeroBackgroundImage hero={heroData} />}

	<!-- <AboutNumbersImage /> -->
	<!-- <ServicesSwiper /> -->
	<ServicesCards categorySlug="general-electricity" />
	<ServicesCards categorySlug="renewable-energy" />
	<About about={about} />
	<LogoNaturelecMarquee />
	<WarrantySteps />
	<AboutMe />
	{
		galleryData && (
			<FeatureLightboxMarquee
				sectionBadge={galleryData.data.sectionBadge}
				sectionTitle={galleryData.data.sectionTitle}
				sectionDescription={galleryData.data.sectionDescription}
				sectionGallery={galleryData.data.sectionGallery}
			/>
		)
	}
	{locationData && <HomePageMap location={locationData} />}
</BaseLayout>
